# Path traversal?
## O que é path traversal?
Path traversal também é conhecido como directory traversal. Essas vulnerabilidades permitem que o atacante leia arquivos arbitrários no servidor que está executando uma aplicação. Isso pode incluir:
- Dados e código da aplicação
- Credenciais para sistemas de back-end
- Arquivos sensíveis de sistemas operacionais

Em alguns casos, um atacante pode ser capaz de escrever arquivos arbitrários no servidor, permitindo-os a modificarem dados ou comportamentos de aplicações e, em casos extremos, tomar controle total do servidor

## Lendo arquivos arbitrários via path traversal
Imagine uma aplicação de shopping que apresenta imagens de itens à venda. O snippet abaixo pode carregar uma imagem utilizando HTML:
```html
<img src="/loadImage?filename=218.png">
```

A URL *loadImage* recebe um parâmetro *filename* e retorna o conteúdo do arquivo especificado. Os arquivos de imagem estão armazenados na localidade */var/www/images/*. Para retornar uma imagem, a aplicação adiciona o arquivo requisitado ao seu diretório base e utiliza uma API de sistema de arquivos para ler o conteúdo do arquivo. Resumidamente, a aplicação lê do seguinte file path:
```plaintext
/var/www/images/218.png
```

A aplicação implementa nenhuma defesa contra ataques path traversal. Por isso, um atacante pode enviar uma requisição pra seguinte URL para obter o arquivo */etc/passwd* do servidor:
```plaintext
https://insecure-website.com/loadImage?filename=../../../etc/passwd
```

Isso faz com que a aplicação leia o seguinte arquivo:
```plaintext
/var/www/images/../../../etc/passwd
```

A sequência *../* é válida num caminho de arquivo e leva a um nível acima da estrutura de diretórios do servidor. Os três consecutivos *../* de */var/www/images/* fazem com que cheguemos na raiz do sistema de arquivos e que o arquivo a ser realmente lido é:
```plaintext
/etc/passwd
```

Em sistemas baseados em Unix, este é um arquivo padrão que contém detalhes dos usuários que estão registrados no servidor, mas um atacante pode obter quaisquer outros arquivos arbitrários utilizando a mesma técnica.

No Windows, ambos *../* e ..\ são sequências transversais de diretórios válidos. O exemplo a seguir é um ataque equivalente contra um servidor baseado em Windows:
```js
https://insecure-website.com/loadImage?filename=..\..\..\windows\win.ini
```

## Laboratório e recursos adicionais
https://www.youtube.com/watch?v=XhieEh9BlGc
https://www.youtube.com/watch?v=17KYOIf5ZbU
https://www.youtube.com/watch?v=Wt0gk05MBz0
https://www.youtube.com/watch?v=3CyrBt0E8AA

---

# Access control
## O que é access control?
Access control é a aplicação de restrições em quem ou o que é autorizado a performar ações ou acessos à recursos. No contexto de aplicações web, access control é dependente na autenticação e gerenciamento de sessões:
- **Autenticação** confirma que o usuário é quem realmente ele diz ser
- **Gerenciamento de sessões** identifica quais requisições HTTP subsequentes estão sendo feitas pelo mesmo usuário
- **Access control (controle de acessos)** determinar se o usuário é permitido executar as ações que o mesmo está tentando performar

Broken access controls são comuns e frequentemente apresentam uma vulnerabilidade de segurança crítica. O design e gerenciamento de controles de acesso é um problema dinâmico e complexo que aplica limitações comerciais, organizacionais e legais à implementação técnica. Como as decisões sobre o design do controle de acessos tem que ser feito por humanos, a chance de erros potenciais surgirem é alta.
![[Pasted image 20250413105328.png]]

## Escalação de privilégios vertical
Se um usuário pode obter acessos a funcionalidades que eles não estão permitidos a acessar, então isto é uma escalação de privilégios vertical. Por exemplo, é um usuário não-administrador pode obter acesso a uma página de admin onde eles podem excluir contas de usuários, então isto é uma escalação de privilégios vertical.

## Funcionalidades desprotegidas
No seu maior princípio, escalação de privilégios vertical surge quando uma aplicação não impõe quaisquer proteções a funcionalidades sensíveis. Por exemplo, funções administrativas podem ser ligadas aa uma página de bem-vindo de administradores, mas não da página de bem-vindo de usuários. No entanto, um usuário pode ser capaz de acessar funções administrativas ao navegar para as URLs de admin relevantes.
Por exemplo, um site pode hospedar funcionalidades sensíveis na seguinte URL:
```plaintext
https://insecure-website.com/admin
```

Isso pode ser acessado por qualquer usuário, não limitado apenas a usuários administrativos que tem o link para a tal funcionalidade na sua UI (user interface). Em alguns casos, a URL administrativa pode ser divulgada em quaisquer outras localidades, como no arquivo *robots.txt*:
```plaintext
https://insecure-website.com/robots.txt
```

Mesmo que a URL não esteja pública em qualquer lugar, um atacante pode ser capaz de usar uma wordlist para fazer brute-force da localidade de quaisquer funcionalidades sensíveis.

## Laboratório e recursos adicionais
https://www.youtube.com/watch?v=qJ8mtm_G40E
https://www.youtube.com/watch?v=XF-SNuSyVNo

## Funcionalidades desprotegidas - continuação
Em alguns casos, funcionalidades sensíveis são escondidas através de de URLs menos previsíveis. Isso é um exemplo de "segurança por obscuridade". No entanto, esconder funcionalidades sensíveis não fornecem controles de acesso efetivos porque usuários podem descobrir as URLs ofuscadas por diversas maneiras.
Imagine uma aplicação que hospeda funções administrativas na seguinte URL:
```plaintext
https://insecure-website.com/administrator-panel-yb556
```

Isso pode não ser diretamente adivinhável por um atacante. No entanto, a aplicação ainda pode vazar a URL aos usuários. Esta URL pode ser descoberta no JavaScript que constrói a interface de usuário baseado na função do usuário:
```html
<script>
	var isAdmin = false;
	if (isAdmin) { 
		... 
		var adminPanelTag = document.createElement('a');
		adminPanelTag.setAttribute('href', 'https://insecure-website.com/administrator-panel-yb556'); 
		adminPanelTag.innerText = 'Admin panel';
		...
	}
</script>
```

Este script adiciona um link à UI do usuário se eles são usuários administradores. No entanto, o script contém uma URL visível a todos os usuários independentemente de sua função.

## Laboratório e recursos adicionais
https://www.youtube.com/watch?v=7Jve11VySNU
https://www.youtube.com/watch?v=mml8SlN2Or4